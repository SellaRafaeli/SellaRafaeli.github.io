<html><head> <meta charset='utf-8'> <title>xsrf_xss_protection_scheme </title><link href="http://kevinburke.bitbucket.org/markdowncss/markdown.css" rel="stylesheet"></link></head><body><a href='/'>Home</a>  |  <a href='/blog'>Blog</a>
<p>Security scheme proposal:</p>

<p>A valid session is defined by:<br />
1. an HTTP-cookie with a user auth-token. (cookie-token)<br />
2. an in-memory (separate) auth-token. (memory-token)</p>

<p>Any POST/credentialed request to server must pass these two, and the server validates both of them. </p>

<p>This should protect against:<br />
1. CSRF - a ‘POST’ from attacker’s website cannot access the in-memory token, and thus will be ignored. <br />
2. XSS session-stealing - using XSS you cannot grab the HTTP-only-cookie. </p>
</body></html>